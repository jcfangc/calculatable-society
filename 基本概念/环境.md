
- [环境](#环境)
  - [1. 地图和环境](#1-地图和环境)
    - [1.1. 单元格表示与特化](#11-单元格表示与特化)
    - [1.2. 地图的构建与特化](#12-地图的构建与特化)

# 环境

## 1. 地图和环境

### 1.1. 单元格表示与特化

每个单元格(`Cell`)代表环境中的一个具体区域，并能够独立包含不同类型的信息。为了确保信息的一致性，我们定义特定类型的`Cell`子类，每个子类对应于地图上具有特定类型信息的单元格：

```python
class BaseCell:
    def __init__(self):
        pass

class HumidityCell(BaseCell):
    def __init__(self, humidity):
        super().__init__()
        self.humidity = humidity

class AltitudeCell(BaseCell):
    def __init__(self, altitude):
        super().__init__()
        self.altitude = altitude

class ResourceCell(BaseCell):
    def __init__(self, resource):
        super().__init__()
        self.resource = resource  # 单元格中的资源

    def update_resource_amount(self, amount):
        """更新单元格中资源的数量"""
        if 'amount' in self.resource.attributes:
            self.resource.attributes['amount'] += amount
        else:
            self.resource.add_attribute('amount', amount)

    def get_resource_amount(self):
        """获取单元格中资源的数量"""
        return self.resource.get_attribute('amount')

    def __str__(self):
        return f"ResourceCell(resource={self.resource})"

# 更多特定类型的单元格子类
```

其中，`Resource`类的详细信息参见[利益：社会资源](利益.md#1-利益：社会资源)。


### 1.2. 地图的构建与特化

地图(`Map`)由这些单元格构成，形成一个二维网格。针对不同类型的信息，我们定义相应的`Map`子类，并在其中使用与之对应的`Cell`子类：

```python
class BaseMap:
    def __init__(self, width, height, cell_type=BaseCell):
        self.width = width
        self.height = height
        self.grid = [[cell_type() for _ in range(width)] for _ in range(height)]

class HumidityMap(BaseMap):
    def __init__(self, width, height, humidity_map):
        super().__init__(width, height, cell_type=HumidityCell)
        for y in range(height):
            for x in range(width):
                self.grid[y][x].humidity = humidity_map[y][x]

class AltitudeMap(BaseMap):
    def __init__(self, width, height, altitude_map):
        super().__init__(width, height, cell_type=AltitudeCell)
        for y in range(height):
            for x in range(width):
                self.grid[y][x].altitude = altitude_map[y][x]

# 更多特定类型的地图子类
```

想象图：

![地图示例](..\pic\2dMap.webp)

